ğŸ”¥ QUICK FIX: 404 ERROR (Backend POST /api/auth/login not found)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âš¡ STEP 1: CHECK SERVER (5 giÃ¢y)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
cd backend
npm run dev

ğŸ‘€ Ká»³ vá»ng tháº¥y:
  âœ… Server middleware initialized
  ğŸ“‹ Registered routes:
     PATCH,GET,PUT,DELETE,POST â†’ /api/auth/register
     PATCH,GET,PUT,DELETE,POST â†’ /api/auth/login

âŒ KhÃ´ng tháº¥y? â†’ npm install && npm run build


âš¡ STEP 2: CHECK FRONTEND URL (1 giÃ¢y)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
.env.local:
  NEXT_PUBLIC_BACKEND_URL=http://localhost:5000
  
src/lib/api.ts:
  const API_URL = process.env.NEXT_PUBLIC_BACKEND_URL;
  
âŒ NEXT_PUBLIC_BACKEND_URL = undefined? â†’ Táº¡o .env.local


âš¡ STEP 3: TEST DIRECT (Postman hoáº·c cURL)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
curl -X POST http://localhost:5000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"phone":"0123456789","password":"password123"}'

âœ… 200 hoáº·c 400 = Route OK (backend Ä‘Ãºng)
âŒ 404 = Backend route sai (check step 1)


âš¡ STEP 4: CHECK NETWORK TAB (Browser DevTools)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
F12 â†’ Network Tab â†’ LÃ m action (login) â†’ Xem request:
  - URL: http://localhost:5000/api/auth/login âœ…
  - Method: POST âœ…
  - Status: 404 âŒ hay 200/400 âœ…
  - Body: {"phone":"...","password":"..."} âœ…


âš¡ STEP 5: READ LOGS (náº¿u váº«n 404)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
From backend start console:
  ğŸ‘‰ [POST] /api/auth/login
  âœ“ [POST] /api/auth/login â†’ 200
  
OR file logs/error-*.log


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ›  COMMON FIXES:

1. "404 Not Found: POST /login" (sai URL)
   Fix: router.post('/login') nhÆ°ng frontend gá»i '/api/auth/login'
   â†’ Frontend: /auth/login (vÃ¬ app.use('/api/auth', authRoutes) prefix)
   
2. "404 Not Found: POST /api/auth/register" (route chÆ°a import)
   Fix: authRoutes khÃ´ng export router
   â†’ backend/src/routes/auth.ts: export default router;
   
3. "req.body undefined" (middleware sai order)
   Fix: express.json() á»Ÿ SAU routes
   â†’ ÄÆ°a app.use(express.json()) LÃŠN TRÆ¯á»šC routes
   
4. "Unauthorized" hoáº·c "401"
   Fix: Backend auth middleware + 401 handler
   â†’ frontend auth-store.ts check token localStorage
   
5. CORS blocked (access blocked by CORS)
   Fix: CORS khÃ´ng allow origin
   â†’ backend: cors({origin: 'http://localhost:3000'})
   
6. "npm ERR! Cannot find module" (Node downgrade)
   Fix: rm -rf backend/node_modules package-lock.json
       npm install
   

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… VERIFY FIX WORKS:

Terminal 1:
  cd backend && npm run dev
  
Terminal 2 (test):
  node backend/test-routes.mjs
  
Expected:
  âœ… Health Check â†’ 200 âœ“
  âœ… Register (Public) â†’ 201 or 409 âœ“
  âœ… Login (Public) â†’ 200 or 401 âœ“
  
  ğŸ‰ ALL ROUTES working! Deploy safe! âœ…


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“š FULL GUIDE: backend/DEBUGGING_404.md

Still stuck? â†’ Copy logs/error-*.log + paste GitHub issue ğŸš€
